<h1>Top {{ topX }} Beers</h1>

<div class="main-content-container">
  <!-- Filters Section -->
  <div class="filter-card">
    <div class="filter-radio-group">
      <mat-radio-group [(ngModel)]="useCustomDate" (change)="onFilterChange()">
        <mat-radio-button [value]="false"> Predefined Range </mat-radio-button>
        <mat-radio-button [value]="true"> Custom Start Date </mat-radio-button>
      </mat-radio-group>
    </div>

    <div class="filter-controls">
      <!-- Predefined Range -->
      @if (!useCustomDate) {
        <mat-form-field appearance="outline">
          <mat-label>Time Range</mat-label>
          <mat-select
            [(ngModel)]="selectedRange"
            (selectionChange)="onFilterChange()"
          >
            @for (option of dateRangeOptions; track option.label) {
              <mat-option [value]="option">{{ option.label }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      }

      <!-- Custom Date Picker -->
      @if (useCustomDate) {
        <mat-form-field appearance="outline">
          <mat-label>Custom Start Date</mat-label>
          <input
            matInput
            [matDatepicker]="picker"
            [(ngModel)]="customStartDate"
            (dateChange)="onFilterChange()"
          />
          <mat-datepicker-toggle
            matSuffix
            [for]="picker"
          ></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>
      }

      <!-- Top X -->
      <mat-form-field appearance="outline">
        <mat-label>Top X Beers</mat-label>
        <mat-select [(ngModel)]="topX" (selectionChange)="onFilterChange()">
          @for (option of topXOptions; track option) {
            <mat-option [value]="option">{{ option }}</mat-option>
          }
        </mat-select>
      </mat-form-field>

      <!-- Min Check-ins -->
      <mat-form-field appearance="outline">
        <mat-label>Minimum Check-ins</mat-label>
        <mat-select
          [(ngModel)]="minCheckins"
          (selectionChange)="onFilterChange()"
        >
          @for (option of minCheckinOptions; track option) {
            <mat-option [value]="option">{{ option }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
    </div>

    @if (transformedTopBeers.length < topX) {
      <p class="filter-results">
        {{ transformedTopBeers.length }} beers matched the criteria.
      </p>
    }
  </div>

  <!-- Main container for cards -->
  <div class="flex-column" style="align-items: stretch; gap: 10px">
    @for (beer of transformedTopBeers; track beer.title; let i = $index) {
      <app-card [cardData]="beer" (badgeClick)="openBadgeDialog($event)">
      </app-card>
    }
  </div>
</div>

<app-powered-by></app-powered-by>
