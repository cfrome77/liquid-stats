<div class="card-container">
  <mat-card class="shared-card">
    <mat-card-content class="beer">
      <div class="header-section">
        @if (cardData.mainImage) {
          <img
            class="beer-label"
            [src]="cardData.mainImage"
            [alt]="cardData.title"
            [title]="cardData.title"
          />
        }

        <div class="beer-info">
          <h3>
            @if (cardData.rank) {
              <span class="rank">#{{ cardData.rank }}</span>
            }
            {{ cardData.title }}
          </h3>
          @if (cardData.subtitle) {
            <p>{{ cardData.subtitle }}</p>
          }
          @if (cardData.breweryName) {
            <p>{{ cardData.breweryName }}</p>
          }
        </div>

        @if (cardData.secondaryImage) {
          <img
            class="brewery-label"
            [src]="cardData.secondaryImage"
            [alt]="cardData.breweryName"
            [title]="cardData.breweryName"
          />
        }
      </div>

      @if (cardData.description) {
        <span class="comment">{{ cardData.description }}</span>
      }
      @if (cardData.hint) {
        <span class="comment">{{ cardData.hint }}</span>
      }

      <div class="rating-bar">
        @if (cardData.rating != null) {
          <app-rating
            [ratingScore]="cardData.rating"
            class="flex-1"
          ></app-rating>
        }
      </div>

      <div class="badges-and-social-links">
        @if (cardData.globalRating != null) {
          <div class="global-rating flex-row align-center gap-4">
            <span class="global-rating-label">Overall Rating:</span>
            <span>{{ cardData.globalRating | number: "1.2-2" }}</span>
          </div>
        }

        <div class="flex-row align-center min-w-0">
          @if (cardData.extraData?.badges && cardData.globalRating == null) {
            <mat-chip-listbox class="chip" selectable="false">
              @for (
                badge of cardData.extraData.badges;
                track badge.badge_name
              ) {
                <mat-chip (click)="onBadgeClick(badge)">
                  <img matChipAvatar [src]="badge.badge_image.sm" alt="badge" />
                  {{ badge.badge_name }}
                </mat-chip>
              }
            </mat-chip-listbox>
          }
        </div>

        <div
          class="flex-shrink-0 flex-row align-center justify-center social-links-wrapper"
        >
          @if (cardData.extraData?.socialLinks) {
            <app-social-links
              [contact]="cardData.extraData.socialLinks"
              [mapData]="cardData.extraData.mapData"
            >
            </app-social-links>
          }
        </div>
      </div>

      <footer>
        <div class="footer-left">
          @if (cardData.footerInfo.link) {
            <a
              target="_blank"
              [href]="cardData.footerInfo.link"
              class="location-link"
              [title]="cardData.footerInfo.text"
            >
              <mat-icon class="location-icon">{{
                cardData.extraData?.venueId ? "location_on" : "info"
              }}</mat-icon>
              <span class="location-text">{{ cardData.footerInfo.text }}</span>
            </a>
          }
        </div>
        <div class="footer-time">
          <time
            [attr.aria-label]="cardData.footerInfo.timestamp"
            [title]="cardData.footerInfo.timestamp"
            >{{ cardData.footerInfo.timestamp }}</time
          >
          <a
            class="checkin-page view-details"
            [href]="
              cardData.extraData?.userName && cardData.extraData?.checkinId
                ? 'https://untappd.com/user/' +
                  cardData.extraData.userName +
                  '/checkin/' +
                  cardData.extraData.checkinId
                : cardData.footerInfo.link
            "
            target="_blank"
            title="{{ cardData.footerInfo?.rightLinkText || 'View Details' }}"
          >
            <mat-icon>open_in_new</mat-icon>
          </a>
        </div>
      </footer>
    </mat-card-content>
  </mat-card>
</div>
